const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-Cy5Zg3fK.js","assets/index-CN5KVo_e.js","assets/index-CSeKaZI2.css"])))=>i.map(i=>d[i]);
import{R as v,j as t,_ as y}from"./index-CN5KVo_e.js";import{M as k}from"./MockupFrame-DGi8SwVP.js";const C="/Manual-Builder/assets/Silk.png",p={sizeRatio:.42,right:-80,bottom:-180,opacity:.3,rotateDeg:0};function R(l,h){const o=[];for(let r=0;r<l.length;r+=h)o.push(l.slice(r,r+h));return o}function S({open:l,onClose:h,title:o,headerUrl:r,shots:i,preset:e,pixelRatio:b}){const x=v.useRef(null),[g,m]=v.useState(1),u=v.useCallback(()=>{const n=x.current;if(!n)return;const a=getComputedStyle(n),d=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight),c=parseFloat(a.paddingTop)+parseFloat(a.paddingBottom),s=n.clientWidth-d,f=n.clientHeight-c,w=Math.min(s/e.width,f/e.height,1);m(w>0&&isFinite(w)?w:1)},[e]);if(v.useLayoutEffect(()=>{if(!l)return;u();const n=new ResizeObserver(u),a=x.current;a&&n.observe(a);const d=()=>u();return window.addEventListener("resize",d),()=>{n.disconnect(),window.removeEventListener("resize",d)}},[l,u]),!l)return null;const j=e.maxCols*e.maxRows,N=R(i,j);async function P(){const{toPng:n}=await y(async()=>{const{toPng:c}=await import("./index-xVp0PEHv.js");return{toPng:c}},[]),a=Array.from(x.current.querySelectorAll("[data-page]"));let d=1;for(const c of a){const s=await n(c,{pixelRatio:b,canvasWidth:e.width,canvasHeight:e.height,style:{transform:"none"}});F(s,`manual-page-${d}.png`),d++}}async function _(){const{default:n}=await y(async()=>{const{default:s}=await import("./jspdf.es.min-Cy5Zg3fK.js").then(f=>f.j);return{default:s}},__vite__mapDeps([0,1,2])),{toPng:a}=await y(async()=>{const{toPng:s}=await import("./index-xVp0PEHv.js");return{toPng:s}},[]),d=Array.from(x.current.querySelectorAll("[data-page]")),c=new n({orientation:e.width>=e.height?"landscape":"portrait",unit:"px",format:[e.width,e.height]});for(let s=0;s<d.length;s++){const f=d[s],w=await a(f,{pixelRatio:b,canvasWidth:e.width,canvasHeight:e.height,style:{transform:"none"}});s>0&&c.addPage([e.width,e.height],e.width>=e.height?"l":"p"),c.addImage(w,"PNG",0,0,e.width,e.height)}c.save("manual.pdf")}return t.jsx("div",{className:"fixed inset-0 z-50 modal-backdrop p-6",children:t.jsxs("div",{className:"mx-auto h-[90%] max-w-[95%] bg-zinc-900 rounded-2xl border border-white/10 overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex items-center gap-3",children:[t.jsx("div",{className:"font-semibold",children:"Pages Preview"}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx("button",{onClick:P,className:"px-3 py-1 rounded bg-brand-600 hover:bg-brand-500",children:"Export PNG"}),t.jsx("button",{onClick:_,className:"px-3 py-1 rounded bg-zinc-800 hover:bg-zinc-700",children:"Export PDF"}),t.jsx("button",{onClick:h,className:"px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600",children:"Close"})]})]}),t.jsx("div",{ref:x,className:"flex-1 overflow-auto p-4",children:t.jsx("div",{className:"space-y-8",children:N.map((n,a)=>t.jsx("div",{className:"mx-auto",style:{width:e.width*g,height:e.height*g},children:t.jsx("div",{style:{transform:`scale(${g})`,transformOrigin:"top left",width:e.width,height:e.height},children:t.jsx(E,{index:a,headerUrl:r,title:o,items:n,preset:e,total:N.length})})},a))})})]})})}function E({index:l,headerUrl:h,title:o,items:r,preset:i,total:e}){const x={display:"grid",gridTemplateColumns:`repeat(${Math.min(i.maxCols,Math.max(1,Math.min(i.maxCols,r.length)))}, 1fr)`,gap:16,alignContent:"center",justifyItems:"center",alignItems:"start",height:i.height-260},g={width:i.width,height:i.height,background:"white",color:"black",borderRadius:16,overflow:"hidden",position:"relative"};return t.jsxs("div",{"data-page":!0,className:"mx-auto border border-black/10 rounded-xl overflow-hidden",style:g,children:[t.jsx("img",{src:C,"aria-hidden":!0,className:"pointer-events-none select-none",style:{position:"absolute",right:p.right,bottom:p.bottom,width:`${Math.floor(i.width*p.sizeRatio)}px`,height:"auto",opacity:p.opacity,transform:`rotate(${p.rotateDeg}deg)`,zIndex:0}}),t.jsxs("div",{children:[t.jsxs("div",{className:"relative h-[180px] w-full",children:[t.jsx("img",{src:h,className:"absolute inset-0 w-full h-full object-fill"}),t.jsx("div",{className:"absolute inset-0"}),t.jsx("div",{className:"absolute inset-0 flex items-cente",children:t.jsx("div",{className:"text-[#002865] px-6 text-left ml-60 my-auto text-5xl font-extrabold leading-tight drop-shadow",children:o})})]}),t.jsx("div",{className:"px-6 py-4",style:{height:i.height-260},children:t.jsx("div",{style:x,children:r.map((m,u)=>{const j=m.annotatedSrc||m.src;return t.jsxs("div",{className:"text-center",children:[t.jsx("div",{style:{filter:"drop-shadow(12px 16px 12px rgba(0,0,0,0.34)) drop-shadow(3px 4px 4px rgba(0,0,0,0.22))"},children:t.jsx(k,{screenUrl:j,width:Math.min(280,Math.floor((i.width-80)/i.maxCols)-24)})}),t.jsxs("div",{className:"mt-5 text-4xl text-[#FF6500] font-bold",children:["Bước ",l*i.maxCols*i.maxRows+u+1,":"]}),t.jsx("div",{className:"text-2xl leading-relaxed text-black/85 max-w-[340px] mx-auto",children:m.description||""})]},m.id)})})}),t.jsxs("div",{className:"h-[60px] w-full grid place-items-center text-xl text-black/80",children:["Trang ",l+1,"/",e]})]})]})}function F(l,h){const o=document.createElement("a");o.href=l,o.download=h,document.body.appendChild(o),o.click(),o.remove()}export{S as default};
